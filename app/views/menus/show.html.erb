<article class="UpdateMenuPage">

    <section class="UpdateMenuPage__main">

        <h1 class="UpdateMenuPage__title">Update Category</h1>
        <h2 class="UpdateMenuPage__subtitle">What's changed?</h1>

        <section class="UpdateMenuPage__colsSection">

          <section class="UpdateMenu__existSection">

              <h3 class="UpdateMenu__existTitle"> Already in Menu </h3>

              <section class="UpdateMenu__exist">
                  <% @menu.menu_item.each do |menu_item| %>
                    <div class="UpdateMenu__existItem">

                      <div class="UpdateMenu__existInfo" >
                        <p class="UpdateMenu__existText"> <%= menu_item.item.name %> </p>
                      </div>

                      <div class="UpdateMenu__existDelete">
                        <%= form_with(url: "/menu_items/#{menu_item.id}",
                                      method: "DELETE",
                                      class: "UpdateMenu__deleteForm",
                                      id: "MenuItemDeleteForm_#{menu_item.id}") do %>
                        <%= image_submit_tag("trash-can-outline.png",
                                            class: "UpdateMenu__deleteIcon",
                                            form: "MenuItemDeleteForm_#{menu_item.id}") %>
                        <% end %>
                      </div>

                    </div>
                <% end %>
            </section>

          </section>

          <section class="UpdateMenu__section">
              <%= form_with(url: "/menus/#{@menu.id}", method: "PUT", class: "UpdateMenu__form") do |update_menu_form| %>

                  <div class="UpdateMenu__textField">
                      <%= update_menu_form.text_field(:name, class: "UpdateMenu__name UpdateMenu__input", value: @menu.name) %>
                  </div>

                  <section class="UpdateMenu__selections">
                      <% selected_items(:update_menu_items_selection).each do |id,item| %>
                          <div class="UpdateMenu__selectedItem">
                              <%= form_with(url: "/items/unselect/#{id}",
                                            method: "DELETE",
                                            class: "UpdateMenu__unselectForm",
                                            id: "UnselectForm_#{id}") do |unselect_form| %>
                                <%= unselect_form.hidden_field(:source, :value => "update_menu_path") %>
                                <%= image_submit_tag("cart.png",
                                                    class: "UpdateMenu__unselectIcon",
                                                    form: "UnselectForm_#{id}") %>
                              <% end %>
                              <p class="UpdateMenu__selectedName"> <%= item["name"] %> </p>
                              <%= update_menu_form.number_field("items[#{id}]",
                                                                class: "UpdateMenu__price",
                                                                placeholder: "Price") %>
                          </div>
                      <% end %>
                  </section>

                  <div class="UpdateMenu__submitField">
                      <%= update_menu_form.submit("Update",
                                                  class: "UpdateMenu__submit",
                                                  :onclick => "hideItemPopupForms()") %>
                  </div>

              <% end %>

              <div class="UpdateMenu__itemField">
                  <%= button_tag("+ Existing Item",
                                type: "button",
                                class: "UpdateMenu__addButton",
                                :onclick => "toggleSelectItemForm()") %>
              </div>

              <div class="UpdateMenu__itemField">
                  <%= button_tag("+ New Item",
                                  type: "button",
                                  class: "UpdateMenu__addButton",
                                  :onclick => "toggleCreateItemForm()") %>
              </div>

          </section>
        </section>
    </section>



    <section class="PopupForm__section" id="selectMenuItemForm">
        <section class="PopupForm__content">

        <h3 class="PopupForm__title"> Select Items </h3>

        <%= form_with(url: "/items/select", method: "POST", class: "SelectMenuItem__form") do |menuitem_form| %>

            <% selectable = non_added_non_selected_items(:update_menu_items_selection) %>
            <% if selectable.length %>
                <div class="SelectMenuItem__selectionField">
                    <%= menuitem_form.collection_check_boxes(:item_id,
                                                            selectable,
                                                            :id,
                                                            :name,
                                                            class: "SelectMenuItem__selectionInput") %>
                </div>
            <% else %>
                <div class="SelectMenuItem__info">
                    <p class="SelectMenuItem__infoText">No more items</p>
                </div>
            <%end %>

            <%= menuitem_form.hidden_field(:source, :value => "update_menu_path") %>

            <div class="SelectMenuItem__submitField">
                <%= menuitem_form.submit("Select", class: "SelectMenuItem__submit") %>
            </div>

        <% end %>

        </section>
    </section>

    <section class="PopupForm__section" id="createMenuItemForm">
        <section class="PopupForm__content">

        <h3 class="PopupForm__title"> Create Item </h3>

        <%= form_with(url: "/items", method: "POST", class: "CreateMenuItem__form") do |menuitem_form| %>

            <div class="CreateMenuItem__textField">
                <%= menuitem_form.label(:name, "Item Name", class: "CreateMenuItem__label") %>
                <%= menuitem_form.text_field(:name, class: "CreateMenuItem__textInput") %>
            </div>

            <div class="CreateMenuItem__textField">
                <%= menuitem_form.label(:name, "Description", class: "CreateMenuItem__label") %>
                <%= menuitem_form.text_area(:description,
                                            class: "CreateMenuItem__textInput CreateMenuItem__longTextInput",
                                            rows: "3",
                                            cols: "34") %>
            </div>

            <div class="CreateMenuItem__selectionField">
                <%= menuitem_form.label(:diet_type, "Diet Type", class: "CreateMenuItem__label") %>
                <%= menuitem_form.collection_radio_buttons(:diet_type,
                                                          %w(Veg Egg NonVeg),
                                                          :downcase,
                                                          :to_s,
                                                          class: "CreateMenuItem__selectionInput") %>
            </div>

            <%= menuitem_form.hidden_field(:source, :value => "update_menu_path") %>

            <div class="CreateMenuItem__submitField">
                <%= menuitem_form.submit("Create", class: "CreateMenuItem__submit", :onclick => "hideItemPopupForms()") %>
            </div>

        <% end %>

        </section>
    </section>
